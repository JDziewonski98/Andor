!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexninepatch=e()}(this,function(){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function n(t,e,i){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var s=Object.getOwnPropertyDescriptor(r,e);return s.get?s.get.call(i):s.value}})(t,e,i||t)}function _(t){return"[object Array]"===Object.prototype.toString.call(t)}function b(t,e,i){return void 0===i&&(i="image"),t[e]||(t[e]=t.scene.make[i]({add:!1,origin:{x:0,y:0}}),t.on("destroy",function(){t[e]&&(t[e].destroy(),t[e]=void 0)})),t[e]}function o(t,e,i){return"__BASE"===i?"".concat(t,",").concat(e):"".concat(i,"_").concat(t,",").concat(e)}var e=Phaser.Utils.Objects.IsPlainObject,i=Phaser.Utils.Objects.GetValue,h=function(t){return"string"==typeof t&&(t=c[t]),t},c={scale:0,repeat:1},t={setTexture:function(t,e,i,r){_(e)&&(r=i,i=e,e=void 0),void 0===e&&(e="__BASE"),this.textureKey=t,this.baseFrameName=e,this.columns.data=i,this.columns.count=i?i.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.rows.data=r,this.rows.count=r?r.length:0,this.rows.stretch=0,this.rows.minHeight=0;var s=this.scene.textures.get(t);if(!s)return this.clear(),this;if(!i||!r)return this.clear(),this;for(var n=s.frames[e],o=n.width,h=0,c=0,a=i.length;c<a;c++)void 0===i[c]?h++:"number"==typeof i[c]?o-=i[c]:o-=i[c].width;var u=o/h,l=n.height,d=0;for(c=0,a=r.length;c<a;c++)void 0===r[c]?d++:"number"==typeof r[c]?l-=r[c]:l-=r[c].width;for(var f,m,v,g,p,y=l/d,b=0,w=0,O=0,x=r.length;O<x;O++){void 0===r[O]&&(r[O]=y),"number"==typeof r[O]&&(r[O]={height:r[O],stretch:O%2}),v=(f=r[O]).height,this.rows.stretch+=0|f.stretch,this.rows.minHeight+=0<f.stretch?0:v;c=b=0;for(var j=i.length;c<j;c++)void 0===i[c]&&(i[c]=u),"number"==typeof i[c]&&(i[c]={width:i[c],stretch:c%2}),g=(m=i[c]).width,0===O&&(this.columns.stretch+=0|m.stretch,this.columns.minWidth+=0<m.stretch?0:g),1<=g&&1<=v?(p=this.getFrameNameCallback(c,O,e))&&s.add(p,0,b+n.cutX,w+n.cutY,g,v):console.warn("Size of Grid(".concat(c,",").concat(O,") = ").concat(g,"x").concat(v,", which is invalid")),b+=g;w+=v}return this.updateTexture(),this},updateTexture:function(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.textures.get(this.textureKey);if(!t)return this;var e,i,r=this.width-this.columns.minWidth;i=0<=r?(e=0<this.columns.stretch?r/this.columns.stretch:0,1):(e=0,this.width/this.columns.minWidth);var s,n,o,h,c,a,u,l=this.height-this.rows.minHeight;n=0<=l?(s=0<this.rows.stretch?l/this.rows.stretch:0,1):(s=0,this.height/this.rows.minHeight);for(var d,f=0,m=0,v=0,g=this.rows.count;v<g;v++){u=0===(c=this.rows.data[v]).stretch?c.height*n:s*c.stretch;for(var p=f=0,y=this.columns.count;p<y;p++)a=0===(h=this.columns.data[p]).stretch?h.width*i:e*h.stretch,(o=this.getFrameNameCallback(p,v,this.baseFrameName))&&0<a&&0<u&&t.has(o)&&(0===(0===c.stretch&&0===h.stretch||0===this.getStretchMode(p,v)?0:1)?(d=b(this,"_image","image")).setTexture(this.textureKey,o).setDisplaySize(a,u):(d=b(this,"_tileSprite","tileSprite")).setTexture(this.textureKey,o).setSize(a,u)),d&&(this.draw(d,f,m),d=void 0),f+=a;m+=u}},setStretchMode:function(t){return e(t)?(this.stretchMode.edge=h(i(t,"edge",0)),this.stretchMode.internal=h(i(t,"internal",0))):(t=h(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this},getStretchMode:function(t,e){return function(t,e){return 0===t||t===this.columns.count-1||0===e||e===this.rows.count-1}.call(this,t,e)?this.stretchMode.edge:this.stretchMode.internal}},a=Phaser.GameObjects.RenderTexture,m=Phaser.Utils.Objects.IsPlainObject,v=Phaser.Utils.Objects.GetValue,u=function(){function l(t,e,i,r,s,n,o,h,c,a){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),m(e)?(e=v(a=e,"x",0),i=v(a,"y",0),r=v(a,"width",1),s=v(a,"height",1),n=v(a,"key",void 0),o=v(a,"baseFrame",void 0),h=v(a,"columns",void 0),c=v(a,"rows",void 0)):m(r)?(r=v(a=r,"width",1),s=v(a,"height",1),n=v(a,"key",void 0),o=v(a,"baseFrame",void 0),h=v(a,"columns",void 0),c=v(a,"rows",void 0)):m(n)?(n=v(a=n,"key",void 0),o=v(a,"baseFrame",void 0),h=v(a,"columns",void 0),c=v(a,"rows",void 0)):m(o)?(o=v(a=o,"baseFrame",void 0),h=v(a,"columns",void 0),c=v(a,"rows",void 0)):_(o)?(a=c,c=h,h=o,o=v(a,"baseFrame",void 0)):m(h)&&(h=v(a=h,"columns",void 0),c=v(a,"rows",void 0)),(u=f(this,d(l).call(this,t,e,i,r,s))).columns={},u.rows={},u.stretchMode={},u._tileSprite=void 0,u._image=void 0,u.setOrigin(.5,.5),u.setGetFrameNameCallback(v(a,"getFrameNameCallback",void 0)),u.setStretchMode(v(a,"stretchMode",0)),u.setTexture(n,o,h,c),u}var t,e,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(l,a),t=l,(e=[{key:"setGetFrameNameCallback",value:function(t){return void 0===t&&(t=o),this.getFrameNameCallback=t,this}},{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(n(d(l.prototype),"resize",this).call(this,t,e),this.updateTexture()),this}},{key:"minWidth",get:function(){return this.columns.minWidth}},{key:"minHeight",get:function(){return this.rows.minHeight}}])&&r(t.prototype,e),i&&r(t,i),l}();return Object.assign(u.prototype,t),u});
