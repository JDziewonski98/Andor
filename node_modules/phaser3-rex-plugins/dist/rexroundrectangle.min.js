!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).rexroundrectangle=e()}(this,function(){"use strict";function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function t(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t,e,n){var r=n.length;if(2<=r){var i=n[r-2],o=n[r-1];if(t===i&&e===o)return n}return n.push(t,e),n}function u(t,e,n,r,i,o,a,u,s){var h,x,l;a&&(o+=360),i=d(i);for(var f=((o=d(o))-i)/u,v=0;v<=u;v++)l=i+f*v,h=t+n*Math.cos(l),x=e+r*Math.sin(l),y(h,x,s);return s}var i=Phaser.Utils.Objects.GetValue,p=function(){function o(t,e,n,r,i){f(this,o),this.cornerRadius={},this._width=0,this._height=0,this.setTo(t,e,n,r,i)}return t(o,[{key:"setTo",value:function(t,e,n,r,i){return this.setPosition(t,e),this.setRadius(i),this.setSize(n,r),this}},{key:"setPosition",value:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}},{key:"setRadius",value:function(t){var e,n;void 0===t&&(t=0),n="number"==typeof t?e=t:(e=i(t,"x",0),i(t,"y",0));var r=this.cornerRadius;return r.tl=a(i(t,"tl",void 0),e,n),r.tr=a(i(t,"tr",void 0),e,n),r.bl=a(i(t,"bl",void 0),e,n),r.br=a(i(t,"br",void 0),e,n),this}},{key:"setSize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"minWidth",get:function(){var t=this.cornerRadius;return Math.max(t.tl.x+t.tr.x,t.bl.x+t.br.x)}},{key:"minHeight",get:function(){var t=this.cornerRadius;return Math.max(t.tl.y+t.bl.y,t.tr.y+t.br.y)}},{key:"width",get:function(){return this._width},set:function(t){null==t&&(t=0),this._width=Math.max(t,this.minWidth)}},{key:"height",get:function(){return this._height},set:function(t){null==t&&(t=0),this._height=Math.max(t,this.minHeight)}},{key:"radius",get:function(){var t=this.cornerRadius;return Math.max(t.tl.x,t.tl.y,t.tr.x,t.tr.y,t.bl.x,t.bl.y,t.br.x,t.br.y)}}]),o}(),a=function(t,e,n){return void 0===t?{x:e,y:n}:"number"==typeof t?{x:t,y:t}:t},e=Math.PI/180,d=function(t){return t*e},s=o;function o(t,e,n){n=n||2;var r,i,o,a,u,s,h,x=e&&e.length,l=x?e[0]*n:t.length,f=g(t,0,l,n,!0),v=[];if(!f||f.next===f.prev)return v;if(x&&(f=function(t,e,n,r){var i,o,a,u,s,h=[];for(i=0,o=e.length;i<o;i++)a=e[i]*r,u=i<o-1?e[i+1]*r:t.length,(s=g(t,a,u,r,!1))===s.next&&(s.steiner=!0),h.push(O(s));for(h.sort(Z),i=0;i<h.length;i++)_(h[i],n),n=b(n,n.next);return n}(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var c=n;c<l;c+=n)(u=t[c])<r&&(r=u),(s=t[c+1])<i&&(i=s),o<u&&(o=u),a<s&&(a=s);h=0!==(h=Math.max(o-r,a-i))?1/h:0}return m(f,v,n,r,i,h),v}function g(t,e,n,r,i){var o,a;if(i===0<F(t,e,n,r))for(o=e;o<n;o+=r)a=A(o,t[o],t[o+1],a);else for(o=n-r;e<=o;o-=r)a=A(o,t[o],t[o+1],a);return a&&h(a,a.next)&&(S(a),a=a.next),a}function b(t,e){if(!t)return t;e=e||t;var n,r=t;do{if(n=!1,r.steiner||!h(r,r.next)&&0!==M(r.prev,r,r.next))r=r.next;else{if(S(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function m(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;for(;null===i.z&&(i.z=R(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next,i!==t;);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,u,s,h=1;do{for(n=t,o=t=null,a=0;n;){for(a++,r=n,e=u=0;e<h&&(u++,r=r.nextZ);e++);for(s=h;0<u||0<s&&r;)0!==u&&(0===s||!r||n.z<=r.z)?(n=(i=n).nextZ,u--):(r=(i=r).nextZ,s--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,h*=2}while(1<a)}(i)}(t,r,i,o);for(var u,s,h=t;t.prev!==t.next;)if(u=t.prev,s=t.next,o?l(t,r,i,o):x(t))e.push(u.i/n),e.push(t.i/n),e.push(s.i/n),S(t),t=s.next,h=s.next;else if((t=s)===h){a?1===a?m(t=w(t,e,n),e,n,r,i,o,2):2===a&&k(t,e,n,r,i,o):m(b(t),e,n,r,i,o,1);break}}}function x(t){var e=t.prev,n=t,r=t.next;if(!(0<=M(e,n,r))){for(var i=t.next.next;i!==t.prev;){if(P(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&0<=M(i.prev,i,i.next))return;i=i.next}return 1}}function l(t,e,n,r){var i=t.prev,o=t,a=t.next;if(!(0<=M(i,o,a))){for(var u=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,s=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,h=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,x=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,l=R(u,s,e,n,r),f=R(h,x,e,n,r),v=t.prevZ,c=t.nextZ;v&&v.z>=l&&c&&c.z<=f;){if(v!==t.prev&&v!==t.next&&P(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&0<=M(v.prev,v,v.next))return;if(v=v.prevZ,c!==t.prev&&c!==t.next&&P(i.x,i.y,o.x,o.y,a.x,a.y,c.x,c.y)&&0<=M(c.prev,c,c.next))return;c=c.nextZ}for(;v&&v.z>=l;){if(v!==t.prev&&v!==t.next&&P(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&0<=M(v.prev,v,v.next))return;v=v.prevZ}for(;c&&c.z<=f;){if(c!==t.prev&&c!==t.next&&P(i.x,i.y,o.x,o.y,a.x,a.y,c.x,c.y)&&0<=M(c.prev,c,c.next))return;c=c.nextZ}return 1}}function w(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!h(i,o)&&T(i,r,r.next,o)&&z(i,o)&&z(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),S(r),S(r.next),r=t=o),r=r.next}while(r!==t);return r}function k(t,e,n,r,i,o){var a,u,s=t;do{for(var h=s.next.next;h!==s.prev;){if(s.i!==h.i&&(u=h,(a=s).next.i!==u.i&&a.prev.i!==u.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&T(n,n.next,t,e))return 1;n=n.next}while(n!==t);return}(a,u)&&z(a,u)&&z(u,a)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;for(;n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next,n!==t;);return r}(a,u))){var x=D(s,h);return s=b(s,s.next),x=b(x,x.next),m(s,e,n,r,i,o),void m(x,e,n,r,i,o)}h=h.next}s=s.next}while(s!==t)}function Z(t,e){return t.x-e.x}function _(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var u=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(u<=i&&a<u){if((a=u)===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var s,h=n,x=n.x,l=n.y,f=1/0;r=n.next;for(;r!==h;)i>=r.x&&r.x>=x&&i!==r.x&&P(o<l?i:a,o,x,l,o<l?a:i,o,r.x,r.y)&&((s=Math.abs(o-r.y)/(i-r.x))<f||s===f&&r.x>n.x)&&z(r,t)&&(n=r,f=s),r=r.next;return n}(t,e)){var n=D(e,t);b(n,n.next)}}function R(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function O(t){for(var e=t,n=t;e.x<n.x&&(n=e),(e=e.next)!==t;);return n}function P(t,e,n,r,i,o,a,u){return 0<=(i-a)*(e-u)-(t-a)*(o-u)&&0<=(t-a)*(r-u)-(n-a)*(e-u)&&0<=(n-a)*(o-u)-(i-a)*(r-u)}function M(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function h(t,e){return t.x===e.x&&t.y===e.y}function T(t,e,n,r){return h(t,e)&&h(n,r)||h(t,r)&&h(n,e)||0<M(t,e,n)!=0<M(t,e,r)&&0<M(n,r,t)!=0<M(n,r,e)}function z(t,e){return M(t.prev,t,t.next)<0?0<=M(t,e,t.next)&&0<=M(t,t.prev,e):M(t,e,t.prev)<0||M(t,t.next,e)<0}function D(t,e){var n=new j(t.i,t.x,t.y),r=new j(e.i,e.x,e.y),i=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=i).prev=n,(r.next=n).prev=r,(o.next=r).prev=o,r}function A(t,e,n,r){var i=new j(t,e,n);return r?(i.next=r.next,(i.prev=r).next.prev=i,r.next=i):(i.prev=i).next=i,i}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function j(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function F(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}o.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(F(t,0,o,n));if(i)for(var u=0,s=e.length;u<s;u++){var h=e[u]*n,x=u<s-1?e[u+1]*n:t.length;a-=Math.abs(F(t,h,x,n))}var l=0;for(u=0;u<r.length;u+=3){var f=r[u]*n,v=r[u+1]*n,c=r[u+2]*n;l+=Math.abs((t[f]-t[c])*(t[1+v]-t[1+f])-(t[f]-t[v])*(t[1+c]-t[1+f]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},o.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);0<i&&(r+=t[i-1].length,n.holes.push(r))}return n};function X(t,e,n,r,i){var o=this.pipeline,a=o._tempMatrix1,u=o._tempMatrix2,s=o._tempMatrix3;t.setPipeline(o),u.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),a.copyFrom(r.matrix),i?(a.multiplyWithOffset(i,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),u.e=e.x,u.f=e.y):(u.e-=r.scrollX*e.scrollFactorX,u.f-=r.scrollY*e.scrollFactorY),a.multiply(u,s);var h=e._displayOriginX,x=e._displayOriginY,l=r.alpha*e.alpha;e.isFilled&&C(o,s,e,l,h,x),e.isStroked&&G(o,e,l,h,x)}var Y=Phaser.Renderer.WebGL.Utils,C=function(t,e,n,r,i,o){for(var a=Y.getTintAppendFloatAlphaAndSwap(n.fillColor,n.fillAlpha*r),u=n.pathData,s=n.pathIndexes,h=0;h<s.length;h+=3){var x=2*s[h],l=2*s[h+1],f=2*s[h+2],v=u[0+x]-i,c=u[1+x]-o,y=u[0+l]-i,p=u[1+l]-o,d=u[0+f]-i,g=u[1+f]-o,b=e.getX(v,c),m=e.getY(v,c),w=e.getX(y,p),k=e.getY(y,p),Z=e.getX(d,g),_=e.getY(d,g);t.setTexture2D(),t.batchTri(b,m,w,k,Z,_,0,0,1,1,a,a,a,t.tintEffect)}},W=Phaser.Renderer.WebGL.Utils,G=function(t,e,n,r,i){var o=t.strokeTint,a=W.getTintAppendFloatAlphaAndSwap(e.strokeColor,e.strokeAlpha*n);o.TL=a,o.TR=a,o.BL=a,o.BR=a;var u=e.pathData,s=u.length-1,h=e.lineWidth,x=h/2,l=u[0]-r,f=u[1]-i;e.closePath||(s-=2);for(var v=2;v<s;v+=2){var c=u[v]-r,y=u[v+1]-i;t.setTexture2D(),t.batchLine(l,f,c,y,x,x,h,v-2,!!e.closePath&&v===s-1),l=c,f=y}},I=function(t,e,n,r){var i=n||e.fillColor,o=r||e.fillAlpha,a=(16711680&i)>>>16,u=(65280&i)>>>8,s=255&i;t.fillStyle="rgba("+a+","+u+","+s+","+o+")"},L=function(t,e,n,r){var i=n||e.strokeColor,o=r||e.strokeAlpha,a=(16711680&i)>>>16,u=(65280&i)>>>8,s=255&i;t.strokeStyle="rgba("+a+","+u+","+s+","+o+")",t.lineWidth=e.lineWidth},E=Phaser.Renderer.Canvas.SetTransform,U={renderWebGL:X,renderCanvas:function(t,e,n,r,i){var o=t.currentContext;if(E(t,o,e,r,i)){var a=e._displayOriginX,u=e._displayOriginY,s=e.pathData,h=s.length-1,x=s[0]-a,l=s[1]-u;o.beginPath(),o.moveTo(x,l),e.closePath||(h-=2);for(var f=2;f<h;f+=2){var v=s[f]-a,c=s[f+1]-u;o.lineTo(v,c)}o.closePath(),e.isFilled&&(I(o,e),o.fill()),e.isStroked&&(L(o,e),o.stroke()),o.restore()}}},H=Phaser.Utils.Objects.GetValue,B=function(){function l(t,e,n,r,i,o,a,u){var s;f(this,l),void 0===e&&(e=0),void 0===n&&(n=0);var h=H(o,"iteration",void 0);o=H(o,"radius",o);var x=new p(0,0,r,i,o);return(s=c(this,v(l).call(this,t,"RoundRectangle",x))).setIteration(h),s.setPosition(e,n),void 0!==a&&s.setFillStyle(a,u),s.updateDisplayOrigin(),s.updateData(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}(l,Phaser.GameObjects.Shape),t(l,[{key:"updateData",value:function(){var t=this.geom,e=this.pathData;e.length=0;var n,r=t.cornerRadius,i=this.iteration+1;if(n=r.br,V(n)){var o=t.width-n.x,a=t.height-n.y;u(o,a,n.x,n.y,0,90,!1,i,e)}else y(t.width,t.height,e);if(n=r.bl,V(n)){o=n.x,a=t.height-n.y;u(o,a,n.x,n.y,90,180,!1,i,e)}else y(0,t.height,e);if(n=r.tl,V(n)){o=n.x,a=n.y;u(o,a,n.x,n.y,180,270,!1,i,e)}else y(0,0,e);if(n=r.tr,V(n)){o=t.width-n.x,a=n.y;u(o,a,n.x,n.y,270,360,!1,i,e)}else y(t.width,0,e);return e.push(e[0],e[1]),this.pathIndexes=s(e),this}},{key:"resize",value:function(t,e){if(void 0===e&&(e=t),this.geom.width===t&&this.geom.height===e)return this;this.geom.height=e,this.geom.width=t,this.updateDisplayOrigin(),this.updateData();var n=this.input;return n&&!n.customHitArea&&(n.hitArea.width=t,n.hitArea.height=e),this}},{key:"setIteration",value:function(t){return void 0===t&&(t=6),this.iteration=t,this}},{key:"setRadius",value:function(t){return void 0===t&&(t=0),this.radius=t,this}},{key:"setCornerRadius",value:function(t){return this.setRadius(t)}},{key:"width",get:function(){return this.geom.width},set:function(t){this.resize(t,this.height)}},{key:"height",get:function(){return this.geom.height},set:function(t){this.resize(this.width,t)}},{key:"iteration",get:function(){return this._iteration},set:function(t){void 0!==this._iteration?this._iteration!==t&&(this._iteration=t,this.updateData()):this._iteration=t}},{key:"radius",get:function(){return this.geom.radius},set:function(t){this.geom.setRadius(t),this.updateDisplayOrigin(),this.updateData()}},{key:"cornerRadius",get:function(){return this.geom.cornerRadius},set:function(t){this.radius=t}}]),l}(),V=function(t){return 0!==t.x&&0!==t.y};return Object.assign(B.prototype,U),B});
