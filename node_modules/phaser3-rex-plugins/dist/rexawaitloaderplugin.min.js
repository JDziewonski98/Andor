!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).rexawaitloaderplugin=t()}(this,function(){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function e(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e,t){var n;return(n=e)&&"function"==typeof n?t={config:{callback:e,scope:t}}:f(e)?(t=e).hasOwnProperty("config")||(t={config:t}):t={key:e,config:t},this.addFile(new s(this,t)),this}var c=Phaser.Loader.FILE_POPULATED,s=function(){function n(e,t){return o(this,n),t.hasOwnProperty("type")||(t.type="await"),t.hasOwnProperty("url")||(t.url=""),t.hasOwnProperty("key")||(t.key=(new Date).getTime().toString()),a(this,i(n).call(this,e,t))}return t(n,Phaser.Loader.File),e(n,[{key:"load",value:function(){if(this.state===c)this.loader.nextFile(this,!0);else{var e=this.config,t=e.callback,n=e.scope,o=this.onLoad.bind(this),r=this.onError.bind(this);t?n?t.call(n,o,r):t(o,r):this.onLoad()}}},{key:"onLoad",value:function(){this.loader.nextFile(this,!0)}},{key:"onError",value:function(){this.loader.nextFile(this,!1)}}]),n}(),f=Phaser.Utils.Objects.IsPlainObject;return function(){function n(e){var t;return o(this,n),t=a(this,i(n).call(this,e)),e.registerFileType("rexAwait",u),t}return t(n,Phaser.Plugins.BasePlugin),e(n,[{key:"addToScene",value:function(e){e.sys.load.rexAwait=u}}]),n}()});
